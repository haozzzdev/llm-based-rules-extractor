{
  "golden_rules": [
    "rule M_Hunting_Dropper_WIREFIRE_1 {\nmeta:\nauthor = \"Mandiant\"\ndescription = \"This rule detects WIREFIRE, a web shell written in Python that exists as trojanized logic to a component of the pulse secure appliance.\"\nmd5 = \"6de651357a15efd01db4e658249d4981\"\nstrings:\n$s1 = \"zlib.decompress(aes.decrypt(base64.b64decode(\" ascii\n$s2 = \"aes.encrypt(t+('\\\\x00'*(16-len(t)%16))\" ascii\n$s3 = \"Handles DELETE request to delete an existing visits data.\" ascii\n$s4 = \"request.data.decode().startswith('GIF'):\" ascii\n$s5 = \"Utils.api_log_admin\" ascii\ncondition:\nfilesize < 10KB\nand all of them\n}",
    "rule M_Hunting_Webshell_LIGHTWIRE_2 {\nmeta:\nauthor = \"Mandiant\"\ndescription = \"Detects LIGHTWIRE based on the RC4\ndecoding and execution 1-liner.\"\nmd5 = \"3d97f55a03ceb4f71671aa2ecf5b24e9\"\nstrings:\n$re1 = /eval\\{my.{1,20}Crypt::RC4->new\\(\\\".{1,50}->RC4\\\n(decode_base64\\(CGI::param\\(\\'.{1,30};eval\\s\\$.{1,30}\\\"Compatibility\n\\scheck:\\s\\$@\\\";\\}/\ncondition:\nfilesize < 10KB\nand all of them\n}",
    "rule M_Hunting_Dropper_THINSPOOL_1 {\nmeta:\nauthor = \"Mandiant\"\ndescription = \"This rule detects THINSPOOL, a dropper that\ninstalls the LIGHTWIRE web shell onto a Pulse Secure system.\"\nmd5 = \"677c1aa6e2503b56fe13e1568a814754\"\nstrings:\n$s1 = \"/tmp/qactg/\" ascii\n$s2 = \"echo '/home/config/dscommands'\" ascii\n$s3 = \"echo '/home/perl/DSLogConfig.pm'\" ascii\n$s4 = \"ADM20447\" ascii\ncondition:\nfilesize < 10KB\nand all of them\n}",
    "rule M_Hunting_CredTheft_WARPWIRE_1\n{\nmeta:\nauthor = \"Mandiant\"\ndescription = \"This rule detects WARPWIRE, a credential stealer\nwritten in Javascript that is embedded into a legitimate Pulse Secure file.\"\nmd5 = \"d0c7a334a4d9dcd3c6335ae13bee59ea\"\nstrings:\n$s1 = {76 61 72 20 77 64 61 74 61 20 3d 20 64 6f 63 75 6d 65 6e\n74 2e 66 72 6d 4c 6f 67 69 6e 2e 75 73 65 72 6e 61 6d 65 2e 76 61 6c 75 65 3b}\n$s2 = {76 61 72 20 73 64 61 74 61 20 3d 20 64 6f 63 75 6d 65 6e\n74 2e 66 72 6d 4c 6f 67 69 6e 2e 70 61 73 73 77 6f 72 64 2e 76 61 6c 75 65 3b}\n$s3 = {2b 77 64 61 74 61 2b 27 26 27 2b 73 64 61 74 61 3b}\n$s4 = {76 61 72 20 78 68 72 20 3d 20 6e 65 77 20 58 4d 4c 48\n74 74 70 52 65 71 75 65 73 74}\n$s5 = \"Remember the last selected auth realm for 30 days\" ascii\ncondition:\nfilesize < 8KB and\nall of them\n}"
  ],
  "output_rules": "[\n  \"rule WARPWIRE_C2_and_Web_Shell_Detection {\\n      meta:\\n          description = \\\"Detects artifacts related to WARPWIRE C2 and associated web shell activities using extracted IOCs\\\"\\n      strings:\\n          $domain1 = \\\"symantke.com\\\"\\n          $file1 = \\\"compcheckresult.cgi\\\"\\n          $file2 = \\\"sessionserver.sh\\\"\\n          $file3 = \\\"lastauthserverused.js\\\"\\n          $file4 = \\\"visits.py\\\"\\n          $file5 = \\\"sessionserver.pl\\\"\\n          $file6 = \\\"libsecure.so.1\\\"\\n      condition:\\n          any of them\\n  }\"\n]"
}